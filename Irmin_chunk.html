<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="Up" href="index.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Irmin_chunk" rel="Chapter" href="Irmin_chunk.html"><title>Irmin_chunk</title>
</head>
<body>
<div class="navbar">&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;</div>
<h1>Module <a href="type_Irmin_chunk.html">Irmin_chunk</a></h1>

<pre><span class="keyword">module</span> Irmin_chunk: <code class="code"><span class="keyword">sig</span></code> <a href="Irmin_chunk.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
Managing Chunks.
<p>

    This module exposes functors to store raw contents into
    append-only stores as chunks of same size. It exposes the <a href="Irmin_chunk.AO.html"><code class="code"><span class="constructor">Irmin_chunk</span>.<span class="constructor">AO</span></code></a>
    functor which split the raw contents into <code class="code"><span class="constructor">Data</span></code> blocks, addressed
    by <code class="code"><span class="constructor">Node</span></code> blocks. That's the usual rope-like representation of
    strings, but chunk trees are always build as perfectly
    well-balanced and blocks are addressed by their hash (or by the
    stable keys returned by the underlying store).
<p>

    A chunk has the following structure:
<p>

<pre class="verbatim">     --------------------------
     | uint8_t type            |
     ---------------------------
     | uint16_t length         |
     ---------------------------
     | byte data[length]       |
     ---------------------------</pre>
<p>

    <code class="code"><span class="keyword">type</span></code> is either <code class="code"><span class="constructor">Data</span></code> (0) or <code class="code"><span class="constructor">Node</span></code> (1). If the chunk contains
    data, <code class="code">length</code> is the payload length. Otherwise it is the number
    of children that the node has.<br>
</div>
<hr width="100%">

<pre><span id="VALchunk_size"><span class="keyword">val</span> chunk_size</span> : <code class="type">int Irmin.Private.Conf.key</code></pre><div class="info ">
<code class="code">chunk_size</code> is the configuration key to configure chunks'
    size. By default, it is set to 4666, so that payload and metadata
    can be stored in a 4K block.<br>
</div>

<pre><span id="VALconfig"><span class="keyword">val</span> config</span> : <code class="type">?config:Irmin.config -> ?size:int -> ?min_size:int -> unit -> Irmin.config</code></pre><div class="info ">
<code class="code">config ?config ?size ?min_size ()</code> is the configuration value
    extending the optional <code class="code">config</code> with bindings associating
    <a href="Irmin_chunk.html#VALchunk_size"><code class="code"><span class="constructor">Irmin_chunk</span>.chunk_size</code></a> to <code class="code">size</code>.
<p>

    Fail with <code class="code"><span class="constructor">Invalid_argument</span></code> if <code class="code">size</code> is smaller than <code class="code">min_size</code>.
    <code class="code">min_size</code> is, by default, set to 4000 (to avoid hash colision on
    smaller size) but can be tweaked for testing purposes. <i>Notes:</i>
    the smaller <code class="code">size</code> is, the bigger the risk of hash collisions, so
    use reasonable values.<br>
</div>

<pre><span class="keyword">module</span> <a href="Irmin_chunk.AO.html">AO</a> <code class="code">(</code><code class="code"><span class="constructor">S</span></code><code class="code"> : </code><code class="type">Irmin.AO_MAKER_RAW</code><code class="code">) </code>: <code class="type">Irmin.AO_MAKER_RAW</code><code class="type"> </code></pre><div class="info">
<code class="code"><span class="constructor">AO</span>(<span class="constructor">X</span>)</code> is an append-only store which store values cut into chunks
    into the underlying store <code class="code"><span class="constructor">X</span></code>.
</div>

<pre><span class="keyword">module</span> <a href="Irmin_chunk.AO_stable.html">AO_stable</a> <code class="code">(</code><code class="code"><span class="constructor">L</span></code><code class="code"> : </code><code class="type">Irmin.LINK_MAKER</code><code class="code">) </code> <code class="code">(</code><code class="code"><span class="constructor">S</span></code><code class="code"> : </code><code class="type">Irmin.AO_MAKER_RAW</code><code class="code">) </code>: <code class="type">Irmin.AO_MAKER_RAW</code><code class="type"> </code></pre><div class="info">
<code class="code"><span class="constructor">AO_stable</span>(<span class="constructor">L</span>)(<span class="constructor">X</span>)</code> is similar to <code class="code"><span class="constructor">AO</span>(<span class="constructor">X</span>)</code> but is ensures that the
    return keys are similar as if they were stored directly in <code class="code"><span class="constructor">X</span></code>, so
    that the fact that blobs are cut into chunks is an implementation
    detail.
</div>
</body></html>